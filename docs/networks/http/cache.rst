===========
Cache
===========

:Author: 王蒙
:Tags: 软件开发，网络编程

:abstract:

    缓存是广泛使用的提高效率的工具。那么如何设计缓存，如何使用使用缓存呢？这个小节，总结我知道的缓存技术。

.. contents::

Audience
========

软件开发，网络编程

Prerequisites
=============

Python, 算法分析与设计

Problem
=======

缓存的应用

缓存的工具

分布式缓存


Solution
========

- 缓存的应用

    - Memorization Algorithm（动态规划）算法用内存空间换时间，缓存会反复使用的中间结果提高计算的效率。
    - 数据库中，缓存常用的查询结果。提高查询效率。
    - CDN 缓存，把资源缓存到离客户近的位置，提高客户访问资源的效率。



- 缓存的工具

    - 可以自己使用内存做缓存。除了自己把数据保存在内存中外。python 的 `functools.lru_cache` 也提供了简便的把数据缓存到内存中的功能。
    - 缓存服务
        - memcached
        - redis

    - Varnish 缓存服务器
    - CDN 缓存服务



- 分布式缓存

    把数据缓存到多台服务器上，为了均衡负载，希望平均地把缓存任务分配给多台服务器。这时，常常使用 hash 函数，尽可能随机的把资源，均匀地缓存到多台服务器上。

    同时，当请求缓存的资源时，希望可以直接找到缓存了该资源的服务器。为此一种可行的做法是： 让缓存服务器从 0 到 N-1 编号。对要缓存的资源（比如资源的url）做 hash, 资源的hash值对 N 取模得到几，就分配到几号缓存服务器。当客户请求缓存资源时，服务器能够根据客户发出的请求（比如请求中包含了资源的 url），算出资源缓存在哪台缓存服务器中，然后直接让该缓存服务器提供资源给客户。

    接下来还有个问题。就是如果要添加或者减少




Reference
=========

Put here references, and links to other documents.
